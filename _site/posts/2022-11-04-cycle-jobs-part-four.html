<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-11-04">
<meta name="description" content="Time To Deal With the Missing Values">

<title>q-pride - Which Cycle Frontier Jobs Are Worth Doing? - Part Four.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">q-pride</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Which Cycle Frontier Jobs Are Worth Doing? - Part Four.</h1>
                  <div>
        <div class="description">
          Time To Deal With the Missing Values
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">game</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">data</div>
                <div class="quarto-category">science</div>
                <div class="quarto-category">exploration</div>
                <div class="quarto-category">cycle</div>
                <div class="quarto-category">frontier</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 4, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#fix-item-names" id="toc-fix-item-names" class="nav-link" data-scroll-target="#fix-item-names">Fix Item Names</a></li>
  <li><a href="#data-drives" id="toc-data-drives" class="nav-link" data-scroll-target="#data-drives">Data Drives:</a>
  <ul class="collapse">
  <li><a href="#add-the-guns" id="toc-add-the-guns" class="nav-link" data-scroll-target="#add-the-guns">Add the Guns</a></li>
  </ul></li>
  <li><a href="#deal-with-backpacks" id="toc-deal-with-backpacks" class="nav-link" data-scroll-target="#deal-with-backpacks">Deal With Backpacks</a></li>
  <li><a href="#deal-with-ammo" id="toc-deal-with-ammo" class="nav-link" data-scroll-target="#deal-with-ammo">Deal with Ammo</a></li>
  <li><a href="#deal-with-the-heavy-mining-tool" id="toc-deal-with-the-heavy-mining-tool" class="nav-link" data-scroll-target="#deal-with-the-heavy-mining-tool">Deal with The Heavy Mining Tool</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome back to the fourth post in the series. Last time, we were having issues with the data since there were missing values - including the Job that prompted the initial investigation. We’ll jump right into it picking up with the mismatch between naming in tables.</p>
<p>While working through the list of problems I found reviewing the data, there is clearly an error in the Regex built before. The symptom of this was the <em>Autoloader</em> which has a hanging number when the group is pulled out.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> siteJobs[<span class="dv">1</span>][[<span class="st">"Name"</span>, <span class="st">"Description"</span>, <span class="st">"Tasks"</span>]].copy()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.isna()]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.<span class="bu">str</span>.contains(<span class="st">"Kill"</span>)]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> <span class="vs">r"(\d+\s[\w]+\s[\w]+)"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasksSubset.Tasks.<span class="bu">str</span>.extractall(regex)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tmp[tmp.reset_index()[<span class="dv">0</span>].<span class="bu">str</span>.contains(<span class="st">'Autoloader'</span>).values]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>1 Autoloader 5</td>
    </tr>
    <tr>
      <th>32</th>
      <th>0</th>
      <td>2 Autoloader 8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>After some work, this was because the hanging <code>[\w]+</code> was too greedy and had to be toned down.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>newRegex <span class="op">=</span> <span class="vs">r"(\d+\s[\w]+\s?[a-zA-Z]+)"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasksSubset.Tasks.<span class="bu">str</span>.extractall(newRegex)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tmp[tmp.reset_index()[<span class="dv">0</span>].<span class="bu">str</span>.contains(<span class="st">'Autoloader'</span>).values]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th></th>
      <th>match</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>1 Autoloader</td>
    </tr>
    <tr>
      <th>32</th>
      <th>0</th>
      <td>2 Autoloader</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This didn’t end up being the only correction to the Regex; in fact, the Co-Tool Multitool was being broken apart since it has a <code>-</code> in the name. So, we had to update this to check and include the <code>-</code> on the split.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>newRegex <span class="op">=</span> <span class="vs">r"((\d+\s[\w\-]+\s?[a-zA-Z]+))"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll have our updated version of the <code>breakLoot</code> function we write before.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakLoot(taskString, index<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    parts <span class="op">=</span> taskString.split(<span class="st">' '</span>, maxsplit<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(parts[index])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> index <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> parts[index]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This shouldn't be called.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> []</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">3</span>):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    tasksSubset <span class="op">=</span> siteJobs[index][[<span class="st">"Name"</span>, <span class="st">"Description"</span>, <span class="st">"Tasks"</span>]].copy()</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.isna()]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.<span class="bu">str</span>.contains(<span class="st">"Kill"</span>)]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    newRegex <span class="op">=</span> <span class="vs">r"((\d+\s[\w\-]+\s?[a-zA-Z]+))"</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tasksSubset.Tasks.<span class="bu">str</span>.extractall(newRegex)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> tmp.reset_index()[<span class="dv">0</span>].<span class="bu">apply</span>(breakLoot).values</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    aLoot <span class="op">=</span> tmp.reset_index()[<span class="dv">0</span>].<span class="bu">apply</span>(breakLoot, index<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tmp.assign(</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> count,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        loot <span class="op">=</span> aLoot</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    nameDescriptSlice <span class="op">=</span> tasksSubset.loc[tmp.reset_index()[<span class="st">"level_0"</span>], [<span class="st">'Name'</span>, <span class="st">'Description'</span>]]</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tmp.assign(</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        name <span class="op">=</span> nameDescriptSlice.Name.values,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        description <span class="op">=</span> nameDescriptSlice.Description.values</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    taskSlice <span class="op">=</span> tmp.reset_index().drop([</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'level_0'</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'match'</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    ], axis <span class="op">=</span><span class="dv">1</span> )</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    taskSlice <span class="op">=</span> taskSlice[[<span class="st">'name'</span>, <span class="st">'count'</span>, <span class="st">'loot'</span>, <span class="st">'description'</span>]]</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    tasks.append(taskSlice)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> pd.concat([<span class="op">*</span>tasks])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fix-item-names" class="level2">
<h2 class="anchored" data-anchor-id="fix-item-names">Fix Item Names</h2>
<p>Now we can continue and move to fixing the name mismatches like intended. There was quite a few of these so I’ll only show the process for a few of them - and then the fix for all of them. We’ll pull the code from the previous post so we can start by using the <code>0</code> values and work backwards.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>allJobs <span class="op">=</span> pd.concat([korolevRewards, icaRewards, osirisRewards])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>lootKMarks <span class="op">=</span> loot.query(<span class="st">'Name == "K-Marks"'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tasks.copy()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>taskLoot <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>taskLoot[<span class="st">'Cost'</span>] <span class="op">=</span> taskLoot[<span class="st">'count'</span>] <span class="op">*</span> taskLoot[<span class="st">'Unit'</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> allJobs.query(<span class="st">'Rewards == "K-Marks"'</span>).merge(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    taskLoot[[<span class="st">'name'</span>, <span class="st">'Cost'</span>]].groupby(<span class="st">'name'</span>).<span class="bu">sum</span>(), left_on<span class="op">=</span><span class="st">"Job"</span>, right_on<span class="op">=</span><span class="st">"name"</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Balance'</span>] <span class="op">=</span> results[<span class="st">'Units'</span>] <span class="op">-</span> results[<span class="st">'Cost'</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># How many are there?</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(results.query(<span class="st">"Cost == 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>30</code></pre>
</div>
</div>
<p>There are 31 rows with a <code>Cost</code> of <code>0</code> which we’ll need to investigate. The first one which I had noticed and corrected in the previous post was the CPU’s so we’ll address this one first. We’ll need to find the values in the <code>tasks</code> table and the <code>lootKMarks</code> table so we can figure out where the disconnect is.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">"Master|Zero"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Mining Bot</td>
      <td>2</td>
      <td>Zero Systems</td>
      <td>Our engineers have designed an autonomous mini...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Insufficient Processing Power</td>
      <td>1</td>
      <td>Master Unit</td>
      <td>Prospector! The Zero Systems CPU you brought u...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Automated Security</td>
      <td>5</td>
      <td>Zero Systems</td>
      <td>We will have to build new turrets to help prot...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Classified I</td>
      <td>2</td>
      <td>Master Unit</td>
      <td>Prospector! We need Derelict Explosives, Maste...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Upgrades</td>
      <td>1</td>
      <td>Master Unit</td>
      <td>We want to take over an ICA Data Center. Stash...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sabotage</td>
      <td>4</td>
      <td>Zero Systems</td>
      <td>Prospector! Those Korolev simpletons are drill...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Spare Parts</td>
      <td>4</td>
      <td>Zero Systems</td>
      <td>One of the Servers at Starport has been failin...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>NEW-Hard-ICA-Gather-6</td>
      <td>1</td>
      <td>Zero Systems</td>
      <td>DESCRIPTION MISSING</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Data Center Upgrades</td>
      <td>2</td>
      <td>Master Unit</td>
      <td>Turns out our data center was not powerful eno...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lootKMarks.loc[lootKMarks.Loot.<span class="bu">str</span>.contains(<span class="st">"CPU"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>3845.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x3</td>
      <td>Yes x3</td>
      <td>Yes</td>
      <td>No</td>
      <td>Master Unit CPU</td>
    </tr>
    <tr>
      <th>321</th>
      <td>506.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Yes x37</td>
      <td>Yes x6</td>
      <td>Yes</td>
      <td>No</td>
      <td>Zero Systems CPU</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The <code>tasks</code> table has a shortened version of its name so the easiest way to fix this would be to append <code>CPU</code> to the <code>loot</code> name in the <code>tasks</code> table.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Master Unit"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Master Unit CPU'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Master Unit CPU"</span>, <span class="st">'loot'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>6     Master Unit CPU
16    Master Unit CPU
47    Master Unit CPU
11    Master Unit CPU
Name: loot, dtype: object</code></pre>
</div>
</div>
<p>Another was the <code>Pure Focus Crystals</code> which has the same problem of having the name truncated; this is a trend among all the affected materials with higher tiered materials. Those will all be included in the final correction and will skip showing the process; it’s literally just the same and tedious.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing the Crystal part</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">"Pure Focus"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>Geologist</td>
      <td>1</td>
      <td>Pure Focus</td>
      <td>You got time for a job, Prospector? The sample...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Industry Secret</td>
      <td>3</td>
      <td>Pure Focus</td>
      <td>Hm. Interesting. The Pure Focus Crystals you b...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Laser Rifles</td>
      <td>3</td>
      <td>Pure Focus</td>
      <td>We are prototyping a new laser rifle that can ...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Arms Race</td>
      <td>4</td>
      <td>Pure Focus</td>
      <td>Prospector. It seems like Korolev is working o...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lootKMarks.loc[lootKMarks.Loot.<span class="bu">str</span>.contains(<span class="st">"Crystal"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>961.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Yes x19</td>
      <td>Yes x10</td>
      <td>Yes</td>
      <td>No</td>
      <td>Focus Crystal</td>
    </tr>
    <tr>
      <th>61</th>
      <td>2883.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x6</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Pure Focus Crystal</td>
    </tr>
    <tr>
      <th>66</th>
      <td>38924.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Yes x6</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Polirium Crystal</td>
    </tr>
    <tr>
      <th>81</th>
      <td>1709.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x36</td>
      <td>Yes x9</td>
      <td>Yes</td>
      <td>No</td>
      <td>Teratomorphic Crystal Core</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This one was a surprise since truncating it doesn’t make any sense and gains nothing but the <code>Magnetic Field Stabilizer</code> is being truncated as well.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing the Stabilizer:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">"Magnetic"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Stability is Key</td>
      <td>1</td>
      <td>Magnetic Field</td>
      <td>Our Comms are jammed. We need you to stash a M...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Storm Interference</td>
      <td>2</td>
      <td>Magnetic Field</td>
      <td>Prospector, the Storm has been distorting all ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Surveillance Center</td>
      <td>2</td>
      <td>Magnetic Field</td>
      <td>We want to expand our surveillance operations ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lootKMarks.loc[lootKMarks.Loot.<span class="bu">str</span>.contains(<span class="st">"Magnetic"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171</th>
      <td>338.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Yes x71</td>
      <td>Yes x25</td>
      <td>Yes</td>
      <td>No</td>
      <td>Magnetic Field Stabilizer</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Lastly, we’ll show the <code>NiC Oil</code> which was a problem from the previous post which is missing the <code>Cannister</code> at the end again.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">"Oil"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>41</th>
      <td>Striking Big</td>
      <td>10</td>
      <td>NiC Oil</td>
      <td>Damn it! We ran out of Fuel for our Radiation ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lootKMarks.loc[lootKMarks.Loot.<span class="bu">str</span>.contains(<span class="st">"Oil"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Name</th>
      <th>Rarity</th>
      <th>Personal Quarters</th>
      <th>Campaigns</th>
      <th>Jobs</th>
      <th>Printing</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>121</th>
      <td>20183.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Yes x103</td>
      <td>Yes x10</td>
      <td>Yes</td>
      <td>No</td>
      <td>NiC Oil Cannister</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There we go! Now, we’ll update the data again and run the merge once more.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most corrections:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Master Unit"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Master Unit CPU'</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Zero Systems"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Zero Systems CPU'</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Pure Focus"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Pure Focus Crystal'</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Heavy Mining"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Heavy Mining Tool'</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Magnetic Field"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Magnetic Field Stabilizer'</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Brittle Titan"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Brittle Titan Ore'</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"NiC Oil"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'NiC Oil Cannister'</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Charged Spinal"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Charged Spinal Base'</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Hardened Bone"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Hardened Bone Plates'</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Pale Ivy"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Pale Ivy Blossom'</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Glowy Brightcap"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Glowy Brightcap Mushroom'</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Blue Runner"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Blue Runner Egg'</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Magic"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Magic-GROW Fertilizer'</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Letium"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Letium Clot'</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Azure Tree"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Azure Tree Bark'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tasks.copy()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>taskLoot <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>taskLoot[<span class="st">'Cost'</span>] <span class="op">=</span> taskLoot[<span class="st">'count'</span>] <span class="op">*</span> taskLoot[<span class="st">'Unit'</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> allJobs.query(<span class="st">'Rewards == "K-Marks"'</span>).merge(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    taskLoot[[<span class="st">'name'</span>, <span class="st">'Cost'</span>]].groupby(<span class="st">'name'</span>).<span class="bu">sum</span>(), left_on<span class="op">=</span><span class="st">"Job"</span>, right_on<span class="op">=</span><span class="st">"name"</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Balance'</span>] <span class="op">=</span> results[<span class="st">'Units'</span>] <span class="op">-</span> results[<span class="st">'Cost'</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(results.query(<span class="st">"Cost == 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>13</code></pre>
</div>
</div>
<p>We’ve made some good progress so far but we’ve still got quite a few jobs to update. Let’s check the list of missing valuse once more and see if there is a new pattern here.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasks.merge(results[[<span class="st">'Job'</span>, <span class="st">'Cost'</span>]], left_on<span class="op">=</span><span class="st">"name"</span>, right_on<span class="op">=</span><span class="st">"Job"</span>, how<span class="op">=</span><span class="st">'left'</span>).query(<span class="st">"Cost == 0"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Job</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>Excavation Gear</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>1</td>
      <td>PKR Maelstrom</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Data Drive II</td>
      <td>1</td>
      <td>Rare Data</td>
      <td>The Data you brought us was helpful, but we ne...</td>
      <td>Data Drive II</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Data Drive III</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Good work last time, Prospector. The Data was ...</td>
      <td>Data Drive III</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Data Drive IV</td>
      <td>1</td>
      <td>Epic Data</td>
      <td>In order to be able to predict Storm Behaviour...</td>
      <td>Data Drive IV</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Data Drive V</td>
      <td>1</td>
      <td>Legendary Data</td>
      <td>Yes! The more precise Data you brought us was ...</td>
      <td>Data Drive V</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Data Drive VI</td>
      <td>3</td>
      <td>Legendary Data</td>
      <td>We're finding more than just Storm data now......</td>
      <td>Data Drive VI</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>Grenadier</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>Ammo Supplies</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Data Drop</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Prospector. One of our Scientists is convinced...</td>
      <td>Data Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
      <td>Provide an Advocate</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Backpack</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The biggest standout problem here now is all those data drive quests so lets resolve those next.</p>
</section>
<section id="data-drives" class="level2">
<h2 class="anchored" data-anchor-id="data-drives">Data Drives:</h2>
<p>We have another problem though since none of the tables we have actually contains the data we’re after. So, we’re back to the wiki to do some more scraping work. If we also look at the names of the data drives we’re going to have another problem soon - which you’ll see when we download the data.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing the Data Drive</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">"Data"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>Data Drive II</td>
      <td>1</td>
      <td>Rare Data</td>
      <td>The Data you brought us was helpful, but we ne...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Data Drive III</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Good work last time, Prospector. The Data was ...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Data Drive IV</td>
      <td>1</td>
      <td>Epic Data</td>
      <td>In order to be able to predict Storm Behaviour...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Data Drive V</td>
      <td>1</td>
      <td>Legendary Data</td>
      <td>Yes! The more precise Data you brought us was ...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Data Drive VI</td>
      <td>3</td>
      <td>Legendary Data</td>
      <td>We're finding more than just Storm data now......</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Data Drop</td>
      <td>2</td>
      <td>Rare Data</td>
      <td>Prospector. One of our Scientists is convinced...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Like the previous posts, scraping is a tedious process of matching keywords and pulling the right tables so that’s getting skipped; it’s just mostly trial and error.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>urlDataDrives <span class="op">=</span> <span class="st">'https://thecyclefrontier.wiki/wiki/Utilities#Data_Drives-0'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>siteDrive <span class="op">=</span> pd.read_html(urlDataDrives, attrs<span class="op">=</span>{<span class="st">"class"</span>:<span class="st">"zebra"</span>})[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll use a modified version of the code we wrote before for parsing the <code>loot</code> table for this.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>driveSubset <span class="op">=</span> siteDrive[</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Image'</span>, <span class="st">'Name'</span>, <span class="st">'Rarity'</span>, <span class="st">'Weight'</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    ].copy()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>driveSubset <span class="op">=</span> driveSubset.assign(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    Loot <span class="op">=</span> np.NaN</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">range</span>( <span class="dv">0</span>, <span class="bu">len</span>(driveSubset) <span class="op">-</span> <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>offset <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> index:</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    aLoot <span class="op">=</span> driveSubset.iloc[i, <span class="dv">1</span>]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    indexes <span class="op">=</span> i <span class="op">+</span> offset</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    driveSubset.iloc[indexes, <span class="dv">4</span>] <span class="op">=</span> aLoot</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> driveSubset.iloc[:, <span class="dv">1</span>:<span class="dv">4</span>]</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.fillna(method<span class="op">=</span><span class="st">"ffill"</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>driveSubset.iloc[:, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">=</span> tmp</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>cutNA <span class="op">=</span> driveSubset.Loot.isna()</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>driveData <span class="op">=</span> driveSubset[ <span class="op">~</span>cutNA ]</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>driveData <span class="op">=</span> driveData.rename(columns<span class="op">=</span>{<span class="st">'Image'</span>:<span class="st">'Unit'</span>, <span class="st">'Name'</span>:<span class="st">'Reward'</span>})</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>driveData[<span class="st">'Rarity'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    driveData.Rarity, categories <span class="op">=</span> [<span class="st">'Common'</span>, <span class="st">'Uncommon'</span>, <span class="st">'Rare'</span>, <span class="st">'Epic'</span>, <span class="st">'Exotic'</span>, <span class="st">'Legendary'</span>]</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>driveData[<span class="st">'Label'</span>] <span class="op">=</span> driveData[<span class="st">'Rarity'</span>].astype(<span class="st">'str'</span>) <span class="op">+</span> <span class="st">' Data'</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>drives <span class="op">=</span> driveData</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>drives</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
      <td>Legendary Data</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Since this is the second time that we’ve needed this - and we’re going to need this again - we should write a function to wrap this whole process.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the function, where:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">## siteData: the table from the scraped site</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">## columns: the columns you want to keep from the scraped data</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">## adjust: the count from the bottom containing an index</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">## step: how many rows between values we care about</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">## offset: how many rewards are there?</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extractSite(siteData, columns, adjust, step,  offset):</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(columns, <span class="bu">list</span>):</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Columns argument must be a list."</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    siteSubset <span class="op">=</span> siteData[columns].copy()</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    siteSubset <span class="op">=</span> siteSubset.assign(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        Loot <span class="op">=</span> np.NaN</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Some extra error handling </span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(adjust, <span class="bu">int</span>):</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"adjust argument must be an int."</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(step, <span class="bu">int</span>):</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"step argument must be an int."</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(offset, <span class="bu">list</span>):</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"offset argument must be a list."</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    index <span class="op">=</span> <span class="bu">range</span>( <span class="dv">0</span>, <span class="bu">len</span>(siteSubset) <span class="op">-</span> adjust, step)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> np.array(offset)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> index:</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        aLoot <span class="op">=</span> siteSubset.iloc[i, <span class="dv">1</span>]</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>        indexes <span class="op">=</span> i <span class="op">+</span> offset</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        siteSubset.iloc[indexes, <span class="bu">len</span>(siteSubset.columns)<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> aLoot</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> siteSubset.iloc[:, <span class="dv">1</span>:<span class="bu">len</span>(siteSubset.columns)]</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    tmp <span class="op">=</span> tmp.fillna(method<span class="op">=</span><span class="st">"ffill"</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    siteSubset.iloc[:, <span class="dv">1</span>:<span class="bu">len</span>(siteSubset.columns)<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> tmp</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    cutNA <span class="op">=</span> siteSubset.Loot.isna()</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    returnData <span class="op">=</span> siteSubset[ <span class="op">~</span>cutNA ]</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    returnData <span class="op">=</span> returnData.rename(columns<span class="op">=</span>{<span class="st">'Image'</span>:<span class="st">'Unit'</span>, <span class="st">'Name'</span>:<span class="st">'Reward'</span>})</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> returnData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll sanity check this to make sure it works.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>drives <span class="op">=</span> extractSite(siteDrive, [<span class="st">'Image'</span>, <span class="st">'Name'</span>, <span class="st">'Rarity'</span>, <span class="st">'Weight'</span>], <span class="dv">2</span>, <span class="dv">3</span>, [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>drives[<span class="st">'Rarity'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        drives.Rarity, categories <span class="op">=</span> [<span class="st">'Common'</span>, <span class="st">'Uncommon'</span>, <span class="st">'Rare'</span>, <span class="st">'Epic'</span>, <span class="st">'Exotic'</span>, <span class="st">'Legendary'</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>drives</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Data Drive Tier 1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Data Drive Tier 2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Data Drive Tier 3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Data Drive Tier 4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Data Drive Tier 5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Perfect! Now we just add this to our list of adjustments right? Sadly no. If you look at the names of the drives you’ll find that we’re not quite there. The names of the drives were renamed in <strong>Season 2</strong> but the values in our tasks were not updated from their previous values. This is not too hard to update since the old drive names were just the <code>Rarity</code> + <code>Data</code> and we have that so we’ll just need a new column.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>drives[<span class="st">'Loot'</span>] <span class="op">=</span> drives[<span class="st">'Rarity'</span>].astype(<span class="st">'str'</span>) <span class="op">+</span> <span class="st">' Data'</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>drives</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Weight</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>Reputation</td>
      <td>Common</td>
      <td>15.0</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>Reputation</td>
      <td>Uncommon</td>
      <td>15.0</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.0</td>
      <td>Reputation</td>
      <td>Rare</td>
      <td>15.0</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>11</th>
      <td>6.0</td>
      <td>Reputation</td>
      <td>Epic</td>
      <td>15.0</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Legendary Data</td>
    </tr>
    <tr>
      <th>14</th>
      <td>10.0</td>
      <td>Reputation</td>
      <td>Legendary</td>
      <td>15.0</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drives</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pd.concat(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    [lootKMarks.rename({<span class="st">"Name"</span>:<span class="st">"Reward"</span>}, axis<span class="op">=</span><span class="dv">1</span>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    drives.query(<span class="st">'Reward == "K-Marks"'</span>).drop(<span class="st">"Weight"</span>, axis<span class="op">=</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Common Data</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1013.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Uncommon Data</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2531.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Data</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6075.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Data</td>
    </tr>
    <tr>
      <th>13</th>
      <td>10252.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Legendary Data</td>
    </tr>
  </tbody>
</table>
<p>99 rows × 4 columns</p>
</div>
</div>
</div>
<p>Add that to our pipeline and let’s see where we are now</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>allJobs <span class="op">=</span> pd.concat([korolevRewards, icaRewards, osirisRewards])</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lootKMarks <span class="op">=</span> loot.query(<span class="st">'Name == "K-Marks"'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Most corrections:</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Master Unit"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Master Unit CPU'</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Zero Systems"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Zero Systems CPU'</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Pure Focus"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Pure Focus Crystal'</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Heavy Mining"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Heavy Mining Tool'</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Magnetic Field"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Magnetic Field Stabilizer'</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Brittle Titan"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Brittle Titan Ore'</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"NiC Oil"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'NiC Oil Cannister'</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Charged Spinal"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Charged Spinal Base'</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Hardened Bone"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Hardened Bone Plates'</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Pale Ivy"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Pale Ivy Blossom'</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Glowy Brightcap"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Glowy Brightcap Mushroom'</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Blue Runner"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Blue Runner Egg'</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Magic"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Magic-GROW Fertilizer'</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Letium"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Letium Clot'</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>tasks.loc[ tasks.loot <span class="op">==</span> <span class="st">"Azure Tree"</span>, <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Azure Tree Bark'</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tasks.copy()</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Stuff here for now:</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>drives <span class="op">=</span> extractSite(siteDrive, [<span class="st">'Image'</span>, <span class="st">'Name'</span>, <span class="st">'Rarity'</span>, <span class="st">'Weight'</span>], <span class="dv">2</span>, <span class="dv">3</span>, [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>drives[<span class="st">'Rarity'</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        drives.Rarity, categories <span class="op">=</span> [<span class="st">'Common'</span>, <span class="st">'Uncommon'</span>, <span class="st">'Rare'</span>, <span class="st">'Epic'</span>, <span class="st">'Exotic'</span>, <span class="st">'Legendary'</span>]</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>drives[<span class="st">'Loot'</span>] <span class="op">=</span> drives[<span class="st">'Rarity'</span>].astype(<span class="st">'str'</span>) <span class="op">+</span> <span class="st">' Data'</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>lootKMarks <span class="op">=</span> pd.concat(</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    [lootKMarks.rename({<span class="st">"Name"</span>:<span class="st">"Reward"</span>}, axis<span class="op">=</span><span class="dv">1</span>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    drives.query(<span class="st">'Reward == "K-Marks"'</span>).drop(<span class="st">"Weight"</span>, axis<span class="op">=</span><span class="dv">1</span>)])</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>taskLoot <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>taskLoot[<span class="st">'Cost'</span>] <span class="op">=</span> taskLoot[<span class="st">'count'</span>] <span class="op">*</span> taskLoot[<span class="st">'Unit'</span>]</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> allJobs.query(<span class="st">'Rewards == "K-Marks"'</span>).merge(</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    taskLoot[[<span class="st">'name'</span>, <span class="st">'Cost'</span>]].groupby(<span class="st">'name'</span>).<span class="bu">sum</span>(), left_on<span class="op">=</span><span class="st">"Job"</span>, right_on<span class="op">=</span><span class="st">"name"</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Balance'</span>] <span class="op">=</span> results[<span class="st">'Units'</span>] <span class="op">-</span> results[<span class="st">'Cost'</span>]</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(results.query(<span class="st">"Cost == 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>7</code></pre>
</div>
</div>
<p>That’s much better! So, what’s left to do?</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasks.merge(results[[<span class="st">'Job'</span>, <span class="st">'Cost'</span>]], left_on<span class="op">=</span><span class="st">"name"</span>, right_on<span class="op">=</span><span class="st">"Job"</span>, how<span class="op">=</span><span class="st">'left'</span>).query(<span class="st">"Cost == 0"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Job</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>Excavation Gear</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>1</td>
      <td>PKR Maelstrom</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>And two smoking Barrels</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>Grenadier</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>Ammo Supplies</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
      <td>Provide an Advocate</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Backpack</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>Loadout Drop</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="add-the-guns" class="level3">
<h3 class="anchored" data-anchor-id="add-the-guns">Add the Guns</h3>
<p>We’re going to move to getting the gun data included since we already actualy have it. This was part of another post which was done - not included in the series.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">"https://thecyclefrontier.wiki/wiki/Weapons"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>siteGun <span class="op">=</span> pd.read_html(url, attrs<span class="op">=</span>{<span class="st">"class"</span>:<span class="st">"zebra"</span>})[<span class="dv">0</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>gunData <span class="op">=</span> siteGun[<span class="op">~</span>siteGun.Type.isna()]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>indx <span class="op">=</span> gunData[<span class="st">'Proj. Speed'</span>] <span class="op">==</span> <span class="st">'Hitscan'</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>gunData.loc[indx, <span class="st">'Proj. Speed'</span>] <span class="op">=</span> np.NaN</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>gunData <span class="op">=</span> gunData.assign(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    Unit <span class="op">=</span> gunData[<span class="st">'Sell Value'</span>].<span class="bu">str</span>.replace(<span class="st">' K-Marks'</span>, <span class="st">''</span>).astype(<span class="st">'float'</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    Reward <span class="op">=</span> <span class="st">"K-Marks"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    Loot <span class="op">=</span> gunData[<span class="st">'Name'</span>]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # This removes the legendary weapons</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># data = data.query('Faction != "Printing"')</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>guns <span class="op">=</span> gunData</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>guns[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]].head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17429.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Advocate</td>
    </tr>
    <tr>
      <th>3</th>
      <td>524.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>AR-55 Autorifle</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12341.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Asp Flechette Gun</td>
    </tr>
    <tr>
      <th>9</th>
      <td>371.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>B9 Trenchgun</td>
    </tr>
    <tr>
      <th>12</th>
      <td>63080.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Basilisk</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1918.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Bulldog</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2052.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>C-32 Bolt Action</td>
    </tr>
    <tr>
      <th>21</th>
      <td>17429.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Gorgon</td>
    </tr>
    <tr>
      <th>24</th>
      <td>16805.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Hammer</td>
    </tr>
    <tr>
      <th>27</th>
      <td>7143.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>ICA Guarantee</td>
    </tr>
    <tr>
      <th>30</th>
      <td>228.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>K-28</td>
    </tr>
    <tr>
      <th>33</th>
      <td>325513.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>KARMA-1</td>
    </tr>
    <tr>
      <th>36</th>
      <td>22781.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>KBR Longshot</td>
    </tr>
    <tr>
      <th>39</th>
      <td>94459.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Kinetic Arbiter</td>
    </tr>
    <tr>
      <th>42</th>
      <td>1918.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>KM-9 'Scrapper'</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now we have the gun data to be added to the <code>loot</code> table but if you were paying attention you may have noticed something is wrong with one of our values.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not sure what this is from.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">' at'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate at</td>
      <td>Our field agent requested better gear to take ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The Advocate in this row is labeled as <code>Advocate at</code> which is another problem. In this instance, instead of trying to deal with the regex we’re just going to update that single value.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">'Advocate at'</span>), <span class="st">'loot'</span>] <span class="op">=</span> <span class="st">'Advocate'</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>tasks.loc[tasks.loot.<span class="bu">str</span>.contains(<span class="st">'Advocate'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>Provide an Advocate</td>
      <td>1</td>
      <td>Advocate</td>
      <td>Our field agent requested better gear to take ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>And, make sure that the append works as intended:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pd.concat(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    [lootKMarks.rename({<span class="st">"Name"</span>:<span class="st">"Reward"</span>}, axis<span class="op">=</span><span class="dv">1</span>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    drives.query(<span class="st">'Reward == "K-Marks"'</span>).drop(<span class="st">"Weight"</span>, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    guns[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]]]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>63</th>
      <td>371.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>S-576 PDW</td>
    </tr>
    <tr>
      <th>66</th>
      <td>1179.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Scarab</td>
    </tr>
    <tr>
      <th>69</th>
      <td>12341.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Shattergun</td>
    </tr>
    <tr>
      <th>72</th>
      <td>34172.0</td>
      <td>K-Marks</td>
      <td>Exotic</td>
      <td>Voltaic Brute</td>
    </tr>
    <tr>
      <th>75</th>
      <td>270540.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Zeus Beam</td>
    </tr>
  </tbody>
</table>
<p>125 rows × 4 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="deal-with-backpacks" class="level2">
<h2 class="anchored" data-anchor-id="deal-with-backpacks">Deal With Backpacks</h2>
<p>We’re going to try to fix the Backpacks, the Shields and the Helmets toegther since they’re all on the same page of the wiki. Again, this data was not part of the previous tables that we had so we’ll need to go get it.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gearUrl <span class="op">=</span> <span class="st">'https://thecyclefrontier.wiki/wiki/Gear'</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>site <span class="op">=</span> pd.read_html(gearUrl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This was tricky to collect - which is only why I’m pointing out how it was done. While working out how to collect the data from the website, there was no good strategy to collect just the data that I wanted. What you will see is that I use hard coded values to pull out where each table is.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>siteBackPacks <span class="op">=</span> site[<span class="dv">0</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>siteHelmet <span class="op">=</span> site[<span class="dv">10</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>siteShield <span class="op">=</span> site[<span class="dv">22</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What I did was <code>enumerate</code> throught all the tables collected to find which results had outlier sizes. I then pulled those to make sure they were what I was after like this:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 22</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">enumerate</span>(<span class="bu">map</span>(<span class="bu">len</span>, site)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>[(0, 22),
 (1, 1),
 (2, 1),
 (3, 3),
 (4, 1),
 (5, 4),
 (6, 1),
 (7, 4),
 (8, 1),
 (9, 1),
 (10, 46),
 (11, 1),
 (12, 1),
 (13, 3),
 (14, 4),
 (15, 4),
 (16, 3),
 (17, 4),
 (18, 4),
 (19, 3),
 (20, 4),
 (21, 4),
 (22, 43),
 (23, 1),
 (24, 1),
 (25, 3),
 (26, 4),
 (27, 4),
 (28, 4),
 (29, 4),
 (30, 4),
 (31, 4),
 (32, 4)]</code></pre>
</div>
</div>
<p>It is not pretty but web scraping rarely is. And, it works. Next we’ll start with the backup packs; with some tweaking of the values to the <code>extractSite</code> function which was defined earlier, this becomes really easy.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>backpacks <span class="op">=</span> extractSite(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    siteData <span class="op">=</span> siteBackPacks.loc[siteBackPacks.Name.<span class="bu">str</span>.contains(<span class="st">"Backpack|K-Marks"</span>)],</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [<span class="st">'Image'</span>, <span class="st">'Name'</span>, <span class="st">'Rarity'</span>, <span class="st">'Space'</span>, <span class="st">'Sale Price'</span>],</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    adjust <span class="op">=</span> <span class="dv">2</span>, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="dv">3</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>backpacks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Space</th>
      <th>Sale Price</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>600.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>200.0</td>
      <td>180  K-Marks</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>2</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>200.0</td>
      <td>180  K-Marks</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2700.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>250.0</td>
      <td>810  K-Marks</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>250.0</td>
      <td>810  K-Marks</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6100.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>300.0</td>
      <td>1,830  K-Marks</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>300.0</td>
      <td>1,830  K-Marks</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>12000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>350.0</td>
      <td>4,000  K-Marks</td>
      <td>Heavy Duty Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>350.0</td>
      <td>4,000  K-Marks</td>
      <td>Heavy Duty Backpack</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Looking at these results though, what we’re really after is the <code>Sale Price</code> and so we’ll need to move some stuff around.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>backpacks <span class="op">=</span> backpacks.assign(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    Unit <span class="op">=</span> backpacks[<span class="st">'Sale Price'</span>].<span class="bu">str</span>.replace(<span class="st">' K-Marks'</span>, <span class="st">''</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>).astype(<span class="st">'float'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>backpacks <span class="op">=</span> backpacks.drop([<span class="st">"Sale Price"</span>, <span class="st">"Space"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>backpacks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>2</th>
      <td>180.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Small Backpack</td>
    </tr>
    <tr>
      <th>4</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Medium Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Large Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Heavy Duty Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Heavy Duty Backpack</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We have the same problem which we had for the Data Drives: the the old name <code>Rare Backpack</code> is in the <code>tasks</code> table but is not how they are named here. Again, we’re just going to steal and modify the solution we had before and apply it here.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>backpacks[<span class="st">'Loot'</span>] <span class="op">=</span> backpacks[<span class="st">'Rarity'</span>].astype(<span class="st">'str'</span>) <span class="op">+</span> <span class="st">' Backpack'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Time to add them to the pipeline.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pd.concat([</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    lootKMarks.rename({<span class="st">"Name"</span>:<span class="st">"Reward"</span>}, axis<span class="op">=</span><span class="dv">1</span>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    drives.query(<span class="st">'Reward == "K-Marks"'</span>).drop(<span class="st">"Weight"</span>, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    guns[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    backpacks</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>150.0</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Flawed Veltecite</td>
    </tr>
    <tr>
      <th>6</th>
      <td>570.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Cloudy Veltecite</td>
    </tr>
    <tr>
      <th>11</th>
      <td>854.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Clear Veltecite</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1922.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Pure Veltecite</td>
    </tr>
    <tr>
      <th>21</th>
      <td>6487.0</td>
      <td>K-Marks</td>
      <td>Legendary</td>
      <td>Veltecite Heart</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>810.0</td>
      <td>K-Marks</td>
      <td>Uncommon</td>
      <td>Uncommon Backpack</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Backpack</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1830.0</td>
      <td>K-Marks</td>
      <td>Rare</td>
      <td>Rare Backpack</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Backpack</td>
    </tr>
    <tr>
      <th>19</th>
      <td>4000.0</td>
      <td>K-Marks</td>
      <td>Epic</td>
      <td>Epic Backpack</td>
    </tr>
  </tbody>
</table>
<p>133 rows × 4 columns</p>
</div>
</div>
</div>
<p>This is much better. So, how many are missing now?</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(results.query(<span class="st">"Cost == 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>4</code></pre>
</div>
</div>
<p>Much better. But, there is actually a new problem here: <strong>masking missing values</strong>. If we look back at our data from before we’ll see that there was Helment and Shield information missing and now it’s gone! Since we’ve fixed some of the values for those jobs the <code>Balance</code> is no longer <code>0</code> and thefore we’ve lost track of it! Let’s step back and look at the merged result and look for mistakes. And, upon doing this we run into our first masked problem.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New Mining Tools</td>
      <td>2.0</td>
      <td>Hydraulic Piston</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Excavator Improvements</td>
      <td>3.0</td>
      <td>Hydraulic Piston</td>
      <td>The suspension on our mining excavators need i...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New Mining Tools</td>
      <td>10.0</td>
      <td>Hardened Metals</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Automated Security</td>
      <td>16.0</td>
      <td>Hardened Metals</td>
      <td>We will have to build new turrets to help prot...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Air Lock Upgrades</td>
      <td>12.0</td>
      <td>Hardened Metals</td>
      <td>Our engineers designed a safer airlock system ...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>211</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Common Backpack</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uncommon Backpack</td>
      <td>810.0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Uncommon Backpack</td>
      <td>810.0</td>
    </tr>
    <tr>
      <th>214</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Epic Backpack</td>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>215</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Epic Backpack</td>
      <td>4000.0</td>
    </tr>
  </tbody>
</table>
<p>216 rows × 6 columns</p>
</div>
</div>
</div>
<p>There are all these <code>NaN</code> values at the bottom which were attached and included due to the <code>outer</code> including all the rows. Can we simply change this over to a <code>left</code>?</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>tmp.loc[tmp.Loot.isna()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Shield</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Loadout Drop</td>
      <td>1</td>
      <td>Rare Helmet</td>
      <td>One of our more... lethal assets on Fortuna re...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This is more in line what I’d have expected. We’ll temporarily keep this - but mostly for discussion purposes. The problem here is that when you look through the wiki there are no sell values for the Shields and Helmets. We cannot get these from the wiki which means we cannot automate it. We could do this manually but then I’d have to constantly update this value when it changes - which I’m trying to avoid. This looks to be a case where we’re going to need to remove this job for now.</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding this to the pipeline:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> tmp.name.<span class="bu">str</span>.contains(<span class="st">"Loadout Drop"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.loc[<span class="op">-</span>idx]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New Mining Tools</td>
      <td>2</td>
      <td>Hydraulic Piston</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hydraulic Piston</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New Mining Tools</td>
      <td>10</td>
      <td>Hardened Metals</td>
      <td>We are producing new Mining Tools for new Pros...</td>
      <td>Hardened Metals</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Explosive Excavation</td>
      <td>4</td>
      <td>Derelict Explosives</td>
      <td>One of our mines collapsed with valuable equip...</td>
      <td>Derelict Explosives</td>
      <td>1709.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mining Bot</td>
      <td>2</td>
      <td>Zero Systems CPU</td>
      <td>Our engineers have designed an autonomous mini...</td>
      <td>Zero Systems CPU</td>
      <td>506.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mining Bot</td>
      <td>3</td>
      <td>Ball Bearings</td>
      <td>Our engineers have designed an autonomous mini...</td>
      <td>Ball Bearings</td>
      <td>338.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Flexible Sealant</td>
      <td>8</td>
      <td>Resin Gun</td>
      <td>A number of our weather balloons took damage f...</td>
      <td>Resin Gun</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>Indigenous Fruit</td>
      <td>4</td>
      <td>Indigenous Fruit</td>
      <td>Ah, Prospector, have you come across any Indig...</td>
      <td>Indigenous Fruit</td>
      <td>759.0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>Indigenous Fruit</td>
      <td>4</td>
      <td>Biological Sampler</td>
      <td>Ah, Prospector, have you come across any Indig...</td>
      <td>Biological Sampler</td>
      <td>1139.0</td>
    </tr>
    <tr>
      <th>140</th>
      <td>Don't get crushed</td>
      <td>3</td>
      <td>Crusher Hide</td>
      <td>Gear up, Prospector! We need Crusher Skins for...</td>
      <td>Crusher Hide</td>
      <td>11533.0</td>
    </tr>
  </tbody>
</table>
<p>137 rows × 6 columns</p>
</div>
</div>
</div>
<p>Ok, so it looks like next will be solving the ammo listings.</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tmp.loc[tmp.Loot.isna()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Excavation Gear</td>
      <td>1</td>
      <td>Heavy Mining Tool</td>
      <td>For excavations, we need you to stash a Heavy ...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>46</th>
      <td>And two smoking Barrels</td>
      <td>200</td>
      <td>Shotgun Ammo</td>
      <td>Prospector. Get down there and stash a PKR Mae...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Ammo Supplies</td>
      <td>1000</td>
      <td>Medium Ammo</td>
      <td>Our Field Agents need more Ammo if they are to...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="deal-with-ammo" class="level2">
<h2 class="anchored" data-anchor-id="deal-with-ammo">Deal with Ammo</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ammoUrl <span class="op">=</span> <span class="st">"https://thecyclefrontier.wiki/wiki/Ammo"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ammo <span class="op">=</span> pd.read_html(ammoUrl)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ve already done this before so this is simply here to show it was done. And, you add it to the pipeline just the same.</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ammo <span class="op">=</span> ammo.rename(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"Item Name"</span>:<span class="st">"Loot"</span>, <span class="st">"Sell Value"</span>:<span class="st">"Unit"</span>}, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    ).assign(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        Reward <span class="op">=</span> <span class="st">"K-Marks"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        Rarity <span class="op">=</span> pd.Categorical(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>            ammo.Rarity, categories <span class="op">=</span> [<span class="st">'Common'</span>, <span class="st">'Uncommon'</span>, <span class="st">'Rare'</span>, <span class="st">'Epic'</span>, <span class="st">'Exotic'</span>, <span class="st">'Legendary'</span>])</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    )[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="deal-with-the-heavy-mining-tool" class="level2">
<h2 class="anchored" data-anchor-id="deal-with-the-heavy-mining-tool">Deal with The Heavy Mining Tool</h2>
<p>Sadly, this tool is on its own page so we’ll need something custom again. There is a table here we can pull but it’s oriented incorrectly for our use.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>site <span class="op">=</span> pd.read_html(<span class="st">"https://thecyclefrontier.wiki/wiki/Heavy_Mining_Tool"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>minerData <span class="op">=</span> site[<span class="dv">0</span>]</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>minerData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Description</td>
      <td>Allows faster mining of materials.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Rarity</td>
      <td>Common</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Weight</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Buy Value</td>
      <td>600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sell Value</td>
      <td>180</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Faction Points</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Thankfully, a data frame has the <strong>Transpose</strong> function that a matrix does. A simple explanation of this function is that it swaps the rows to columns and columns to rows.</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>minerData[<span class="dv">0</span>].T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>0       Description
1            Rarity
2            Weight
3         Buy Value
4        Sell Value
5    Faction Points
Name: 0, dtype: object</code></pre>
</div>
</div>
<p>We’re going to extract the rows values to create a new dataframe object. Since the <code>Heaving Mining Tool</code> designation is missing from the data then we’ll need to add it ourself.</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> minerData[<span class="dv">1</span>].T.to_list() <span class="op">+</span> [<span class="st">'Heavy Mining Tool'</span>]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>['Allows faster mining of materials.',
 'Common',
 '30',
 '600',
 '180',
 '2',
 'Heavy Mining Tool']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> minerData[<span class="dv">0</span>].to_list() <span class="op">+</span> [<span class="st">'Loot'</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>['Description',
 'Rarity',
 'Weight',
 'Buy Value',
 'Sell Value',
 'Faction Points',
 'Loot']</code></pre>
</div>
</div>
<p>And, join them together.</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mineTool <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> columns)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mineTool.loc[<span class="dv">0</span>] <span class="op">=</span> row</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>mineTool <span class="op">=</span> mineTool.assign(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    Reward <span class="op">=</span> <span class="st">"K-Marks"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    Rarity <span class="op">=</span> pd.Categorical(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        mineTool.Rarity, categories <span class="op">=</span> [<span class="st">'Common'</span>, <span class="st">'Uncommon'</span>, <span class="st">'Rare'</span>, <span class="st">'Epic'</span>, <span class="st">'Exotic'</span>, <span class="st">'Legendary'</span>]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    Unit <span class="op">=</span> mineTool[<span class="st">'Sell Value'</span>].astype(<span class="bu">int</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]]</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>mineTool</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unit</th>
      <th>Reward</th>
      <th>Rarity</th>
      <th>Loot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>180</td>
      <td>K-Marks</td>
      <td>Common</td>
      <td>Heavy Mining Tool</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>And, add it to the pipeline.</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lootKMarks <span class="op">=</span> pd.concat([</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    lootKMarks.rename({<span class="st">"Name"</span>:<span class="st">"Reward"</span>}, axis<span class="op">=</span><span class="dv">1</span>)[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    drives.query(<span class="st">'Reward == "K-Marks"'</span>).drop(<span class="st">"Weight"</span>, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    guns[[<span class="st">'Unit'</span>, <span class="st">'Reward'</span>, <span class="st">'Rarity'</span>, <span class="st">'Loot'</span>]],</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    backpacks,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ammo,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    mineTool</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop this quest</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> tasks.name.<span class="bu">str</span>.contains(<span class="st">"Loadout Drop"</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tasks.loc[<span class="op">-</span>idx]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>taskLoot <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>taskLoot[<span class="st">'Cost'</span>] <span class="op">=</span> taskLoot[<span class="st">'count'</span>] <span class="op">*</span> taskLoot[<span class="st">'Unit'</span>]</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> allJobs.query(<span class="st">'Rewards == "K-Marks"'</span>).merge(</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    taskLoot[[<span class="st">'name'</span>, <span class="st">'Cost'</span>]].groupby(<span class="st">'name'</span>).<span class="bu">sum</span>(), left_on<span class="op">=</span><span class="st">"Job"</span>, right_on<span class="op">=</span><span class="st">"name"</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Balance'</span>] <span class="op">=</span> results[<span class="st">'Units'</span>] <span class="op">-</span> results[<span class="st">'Cost'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>results.query(<span class="st">"Cost == 0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>77</th>
      <td>2400</td>
      <td>K-Marks</td>
      <td>Grenadier</td>
      <td>0.0</td>
      <td>2400.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>155000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
      <td>155000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasks.merge(lootKMarks[[<span class="st">'Loot'</span>, <span class="st">'Unit'</span>]], left_on<span class="op">=</span><span class="st">'loot'</span>, right_on<span class="op">=</span><span class="st">'Loot'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>tmp.loc[tmp.Loot.isna()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>count</th>
      <th>loot</th>
      <th>description</th>
      <th>Loot</th>
      <th>Unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>Grenadier</td>
      <td>1</td>
      <td>Frag Grenade</td>
      <td>Prospector. You have heard of Badum's Dead Dro...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>151</th>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>1</td>
      <td>Alpha Crusher</td>
      <td>DESCRIPTION MISSING</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>This is the best we’ll get I suppose. Now, back to our check: How bad is our good old job <code>And two smoking Barrels</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>results.loc[results.Job.<span class="bu">str</span>.contains(<span class="st">"Barrel"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>19000</td>
      <td>K-Marks</td>
      <td>And two smoking Barrels</td>
      <td>40716.0</td>
      <td>-21716.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>And, there we go! So, how many jobs have a negative balance?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>results.query(<span class="st">"Balance &lt; 0 "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>19000</td>
      <td>K-Marks</td>
      <td>And two smoking Barrels</td>
      <td>40716.0</td>
      <td>-21716.0</td>
    </tr>
    <tr>
      <th>70</th>
      <td>9500</td>
      <td>K-Marks</td>
      <td>Data Drive III</td>
      <td>10124.0</td>
      <td>-624.0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>56000</td>
      <td>K-Marks</td>
      <td>Data Drive VI</td>
      <td>61512.0</td>
      <td>-5512.0</td>
    </tr>
    <tr>
      <th>81</th>
      <td>17000</td>
      <td>K-Marks</td>
      <td>Ammo Supplies</td>
      <td>69000.0</td>
      <td>-52000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>That’s not as bad as I expected. What is the average job balance?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>results.Balance.mean(), results.Balance.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>(13300.702127659575, 11256.0)</code></pre>
</div>
</div>
<p>So, what jobs are above the mean?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>results.query(<span class="ss">f"Balance &gt;= </span><span class="sc">{</span>results<span class="sc">.</span>Balance<span class="sc">.</span>mean()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Units</th>
      <th>Rewards</th>
      <th>Job</th>
      <th>Cost</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Excavator Improvements</td>
      <td>4306.0</td>
      <td>20694.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>A new type of Alloy</td>
      <td>15468.0</td>
      <td>21532.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Automated Security</td>
      <td>4930.0</td>
      <td>22070.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>52000</td>
      <td>K-Marks</td>
      <td>Classified I</td>
      <td>27030.0</td>
      <td>24970.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Geologist</td>
      <td>6727.0</td>
      <td>20273.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>29000</td>
      <td>K-Marks</td>
      <td>Industry Secret</td>
      <td>8649.0</td>
      <td>20351.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>34000</td>
      <td>K-Marks</td>
      <td>Veltecite Hearts</td>
      <td>12974.0</td>
      <td>21026.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>40000</td>
      <td>K-Marks</td>
      <td>Laser Rifles</td>
      <td>18259.0</td>
      <td>21741.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>47000</td>
      <td>K-Marks</td>
      <td>Classified II</td>
      <td>23922.0</td>
      <td>23078.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>41000</td>
      <td>K-Marks</td>
      <td>Unlimited Power</td>
      <td>17377.0</td>
      <td>23623.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Meteor Core</td>
      <td>7594.0</td>
      <td>19406.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Shards of pure Power</td>
      <td>8104.0</td>
      <td>21896.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>48000</td>
      <td>K-Marks</td>
      <td>Battery Day</td>
      <td>22782.0</td>
      <td>25218.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>28000</td>
      <td>K-Marks</td>
      <td>Upgrades</td>
      <td>3845.0</td>
      <td>24155.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>140000</td>
      <td>K-Marks</td>
      <td>Exclusive Drilling Rights</td>
      <td>115330.0</td>
      <td>24670.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>32000</td>
      <td>K-Marks</td>
      <td>Stocking Up</td>
      <td>9120.0</td>
      <td>22880.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Shock and Awe</td>
      <td>11385.0</td>
      <td>14615.0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>Sabotage</td>
      <td>15696.0</td>
      <td>21304.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>28000</td>
      <td>K-Marks</td>
      <td>Old Currency</td>
      <td>6000.0</td>
      <td>22000.0</td>
    </tr>
    <tr>
      <th>52</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Recoil Compensation</td>
      <td>9390.0</td>
      <td>16610.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>45000</td>
      <td>K-Marks</td>
      <td>New 3D Printer</td>
      <td>21362.0</td>
      <td>23638.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>Arms Race</td>
      <td>11532.0</td>
      <td>21468.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>35000</td>
      <td>K-Marks</td>
      <td>Energy Crisis</td>
      <td>18984.0</td>
      <td>16016.0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Data Drive IV</td>
      <td>12150.0</td>
      <td>13850.0</td>
    </tr>
    <tr>
      <th>76</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>A Solution</td>
      <td>10125.0</td>
      <td>22875.0</td>
    </tr>
    <tr>
      <th>82</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Data Drop</td>
      <td>10124.0</td>
      <td>14876.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Field Supplies</td>
      <td>3000.0</td>
      <td>23000.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Spare Parts</td>
      <td>2024.0</td>
      <td>22976.0</td>
    </tr>
    <tr>
      <th>90</th>
      <td>29000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-ICA-Gather-6</td>
      <td>9142.0</td>
      <td>19858.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>227000</td>
      <td>K-Marks</td>
      <td>Striking Big</td>
      <td>201830.0</td>
      <td>25170.0</td>
    </tr>
    <tr>
      <th>93</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>A Craving</td>
      <td>4048.0</td>
      <td>20952.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>26000</td>
      <td>K-Marks</td>
      <td>Cretins</td>
      <td>6300.0</td>
      <td>19700.0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>27000</td>
      <td>K-Marks</td>
      <td>Sensor Array Repairs</td>
      <td>6908.0</td>
      <td>20092.0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>32000</td>
      <td>K-Marks</td>
      <td>A new Energy Source</td>
      <td>11289.0</td>
      <td>20711.0</td>
    </tr>
    <tr>
      <th>100</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Data Center Upgrades</td>
      <td>7690.0</td>
      <td>22310.0</td>
    </tr>
    <tr>
      <th>101</th>
      <td>30000</td>
      <td>K-Marks</td>
      <td>Keep the Experiment running</td>
      <td>7200.0</td>
      <td>22800.0</td>
    </tr>
    <tr>
      <th>102</th>
      <td>61000</td>
      <td>K-Marks</td>
      <td>Safety Measures</td>
      <td>36309.0</td>
      <td>24691.0</td>
    </tr>
    <tr>
      <th>122</th>
      <td>31000</td>
      <td>K-Marks</td>
      <td>Harvest Day</td>
      <td>6583.0</td>
      <td>24417.0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>37000</td>
      <td>K-Marks</td>
      <td>Core Values</td>
      <td>15188.0</td>
      <td>21812.0</td>
    </tr>
    <tr>
      <th>126</th>
      <td>45000</td>
      <td>K-Marks</td>
      <td>Promising Results</td>
      <td>21266.0</td>
      <td>23734.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>24000</td>
      <td>K-Marks</td>
      <td>Stormy Samples</td>
      <td>2700.0</td>
      <td>21300.0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>25000</td>
      <td>K-Marks</td>
      <td>Stormy Samples II</td>
      <td>2024.0</td>
      <td>22976.0</td>
    </tr>
    <tr>
      <th>132</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>Loadout Drop</td>
      <td>7320.0</td>
      <td>25680.0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>33000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-Gather-7</td>
      <td>12816.0</td>
      <td>20184.0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>155000</td>
      <td>K-Marks</td>
      <td>NEW-Hard-Osiris-EliteCrusher-1</td>
      <td>0.0</td>
      <td>155000.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Perfect! Next we’ll loop back around to automating the pipeline and uploading the data to Kaggle.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>