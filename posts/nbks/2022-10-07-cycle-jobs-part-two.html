<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-10-07">
<meta name="description" content="Second We’ll Clean the Tasks.">

<title>Orgulo.us - Which Cycle Frontier Jobs Are Worth Doing? - Part Two.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Orgulo.us</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Shoklan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Which Cycle Frontier Jobs Are Worth Doing? - Part Two.</h1>
                  <div>
        <div class="description">
          Second We’ll Clean the Tasks.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">game</div>
                <div class="quarto-category">python</div>
                <div class="quarto-category">data</div>
                <div class="quarto-category">science</div>
                <div class="quarto-category">exploration</div>
                <div class="quarto-category">cycle</div>
                <div class="quarto-category">frontier</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 7, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This is Part Two of a Series towards scraping, cleaning and analyzing the Jobs for The Cycle: Frontier. If you haven’t read Part One then I’d suggest start <a href="https://orgulo.us/game/python/data/science/exploration/cycle/frontier/2022/09/28/cycle-jobs-part-one.html">there</a>. We’re picking up now with cleaning the tasks to complete for the job instead. So, let’s get started! We’ll pull our normal libraries for working on projects like this.</p>
<div id="cell-2" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd             <span class="co"># for the data.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np              <span class="co"># for a NaN type</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt <span class="co"># For plotting, and some customization of plots.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns           <span class="co"># For pretty plots.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix the size of the graphs</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(rc<span class="op">=</span>{<span class="st">"figure.figsize"</span>:(<span class="dv">11</span>, <span class="dv">8</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’re actually going to be using the same data table as before from the <a href="https://thecyclefrontier.wiki/wiki/Main_Page">Official Wiki</a> and the <a href="https://thecyclefrontier.wiki/wiki/Jobs"><strong>Jobs Page</strong></a>. Like before, wer’e going to use the same <code>read_html()</code> call targetting the <code>name</code> class.</p>
<div id="cell-4" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># game taken down</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># url = "https://thecyclefrontier.wiki/wiki/Jobs"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://archive.ph/HZfyf'</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>site <span class="op">=</span> pd.read_html(url, match<span class="op">=</span><span class="st">"Name"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    converters <span class="op">=</span> {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Name"</span>: <span class="bu">str</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Description"</span>: <span class="bu">str</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Unlocked"</span>: <span class="bu">int</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tasks"</span>: <span class="bu">str</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Rewards"</span>: <span class="bu">str</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And here is the data in the weird rows and columns like before:</p>
<div id="cell-6" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weird Problem: Data Looks funny, can still use this:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>site[<span class="dv">0</span>].head(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Description</th>
<th data-quarto-table-cell-role="th">Unlock Level</th>
<th data-quarto-table-cell-role="th">Difficulty</th>
<th data-quarto-table-cell-role="th">Tasks</th>
<th data-quarto-table-cell-role="th">Rewards</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
<td>4.0</td>
<td>Easy</td>
<td>Collect: 2 Hydraulic Piston 10 Hardened Metals</td>
<td>3800 K-Marks 1 Korolev Scrip 15 Korolev R...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3800</td>
<td>K-Marks</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Korolev Scrip</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>15</td>
<td>Korolev Reputation</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
<td>7.0</td>
<td>Medium</td>
<td>Collect: 4 Derelict Explosives</td>
<td>11000 K-Marks 8 Korolev Scrip 52 Korolev ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>11000</td>
<td>K-Marks</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>8</td>
<td>Korolev Scrip</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>52</td>
<td>Korolev Reputation</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We’re going to make a copy of the specific columns we want to avoid any strange insert/update issues.</p>
<div id="cell-8" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> site[<span class="dv">0</span>][[<span class="st">"Name"</span>, <span class="st">"Description"</span>, <span class="st">"Tasks"</span>]].copy()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tasksSubset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Description</th>
<th data-quarto-table-cell-role="th">Tasks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
<td>Collect: 2 Hydraulic Piston 10 Hardened Metals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3800</td>
<td>K-Marks</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Korolev Scrip</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>15</td>
<td>Korolev Reputation</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
<td>Collect: 4 Derelict Explosives</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">183</td>
<td>470</td>
<td>Korolev Reputation</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">184</td>
<td>No Expiry Date</td>
<td>There you are, finally! There's been an accide...</td>
<td>Collect: 10 Old Medicine</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">185</td>
<td>6300</td>
<td>K-Marks</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9</td>
<td>Korolev Scrip</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">187</td>
<td>62</td>
<td>Korolev Reputation</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>188 rows × 3 columns</p>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of the middle stuff we don't need.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.isna()]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tasksSubset.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Description</th>
<th data-quarto-table-cell-role="th">Tasks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
<td>Collect: 2 Hydraulic Piston 10 Hardened Metals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
<td>Collect: 4 Derelict Explosives</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
<td>Collect: 2 Zero Systems CPU 3 Ball Bearings</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>None of your Business</td>
<td>Prospector. We need Toxic Glands. Don't ask qu...</td>
<td>Collect: 2 Toxic Glands</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Insufficient Processing Power</td>
<td>Prospector! The Zero Systems CPU you brought u...</td>
<td>Collect: 1 Master Unit CPU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Excavator Improvements</td>
<td>The suspension on our mining excavators need i...</td>
<td>Collect: 2 Co-TEC MultiTool 3 Ball Bearings 3 ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>A new type of Alloy</td>
<td>Our scientists are confident they can create a...</td>
<td>Collect: 4 Hardened Bone Plates 12 Compound Sh...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>Automated Security</td>
<td>We will have to build new turrets to help prot...</td>
<td>Collect: 5 Zero Systems CPU 16 Hardened Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Energy Crisis</td>
<td>Veltecite supplies are low, but we need energy...</td>
<td>Collect: 4 Miniature Reactor</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>Classified I</td>
<td>Prospector! We need Derelict Explosives, Maste...</td>
<td>Collect: 10 Derelict Explosives 2 Master Unit ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Clear Veltecite</td>
<td>The Veltecite you brought us the other day is ...</td>
<td>Collect: 2 Clear Veltecite</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44</td>
<td>Time to Focus</td>
<td>One of our miners searching the Jungle for Foc...</td>
<td>Kill 6 Creatures at Jungle Collect: 4 Focus Cr...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48</td>
<td>Pure Veltecite</td>
<td>The Clear Veltecite was an improvement, we gai...</td>
<td>Collect: 2 Pure Veltecite</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">52</td>
<td>Titans of Industry</td>
<td>Scouts have found Titan Ore deposits on Fortun...</td>
<td>Collect: 2 Titan Ore 6 Altered Nickel</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>Crystal Frenzy</td>
<td>We're working on a new type of laser for our l...</td>
<td>Collect: 2 Clear Veltecite 8 Focus Crystal</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As I discussed in the previous post, there are three kinds of jobs: <em>Collect</em>, <em>Deposit</em> and <em>Kill</em>. The <em>Collect</em> and <em>Deposit</em> jobs are fine since they involved something easily quantifiable: <strong>loot</strong>. However, the <em>Kill</em> quests present a very real problem since there is no simple way to address quanitfying them. For killing creatures, maybe we could take the sum of their expected drops and their rate of drop and include that as part of the rewards? Of course, the player may simply choose not to pick any of that up.</p>
<p>Another problem is killing players; how much is a player kill actually worth? And, the difficulty of killing players is connected to the skill level of each player - which we also cannot know. Therefore, I’ve elected to remove the <strong>Kill Jobs</strong> from the analysis.</p>
<div id="cell-11" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anything with kill just remove until I can think of a better way to deal with this.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tasksSubset <span class="op">=</span> tasksSubset[ <span class="op">~</span>tasksSubset.Tasks.<span class="bu">str</span>.contains(<span class="st">"Kill"</span>)]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>tasksSubset.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Description</th>
<th data-quarto-table-cell-role="th">Tasks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
<td>Collect: 2 Hydraulic Piston 10 Hardened Metals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
<td>Collect: 4 Derelict Explosives</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
<td>Collect: 2 Zero Systems CPU 3 Ball Bearings</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>None of your Business</td>
<td>Prospector. We need Toxic Glands. Don't ask qu...</td>
<td>Collect: 2 Toxic Glands</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Insufficient Processing Power</td>
<td>Prospector! The Zero Systems CPU you brought u...</td>
<td>Collect: 1 Master Unit CPU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Excavator Improvements</td>
<td>The suspension on our mining excavators need i...</td>
<td>Collect: 2 Co-TEC MultiTool 3 Ball Bearings 3 ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>A new type of Alloy</td>
<td>Our scientists are confident they can create a...</td>
<td>Collect: 4 Hardened Bone Plates 12 Compound Sh...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28</td>
<td>Automated Security</td>
<td>We will have to build new turrets to help prot...</td>
<td>Collect: 5 Zero Systems CPU 16 Hardened Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>Energy Crisis</td>
<td>Veltecite supplies are low, but we need energy...</td>
<td>Collect: 4 Miniature Reactor</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36</td>
<td>Classified I</td>
<td>Prospector! We need Derelict Explosives, Maste...</td>
<td>Collect: 10 Derelict Explosives 2 Master Unit ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Clear Veltecite</td>
<td>The Veltecite you brought us the other day is ...</td>
<td>Collect: 2 Clear Veltecite</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48</td>
<td>Pure Veltecite</td>
<td>The Clear Veltecite was an improvement, we gai...</td>
<td>Collect: 2 Pure Veltecite</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>Titans of Industry</td>
<td>Scouts have found Titan Ore deposits on Fortun...</td>
<td>Collect: 2 Titan Ore 6 Altered Nickel</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>Crystal Frenzy</td>
<td>We're working on a new type of laser for our l...</td>
<td>Collect: 2 Clear Veltecite 8 Focus Crystal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60</td>
<td>Geologist</td>
<td>You got time for a job, Prospector? The sample...</td>
<td>Collect: 2 Pure Veltecite 1 Pure Focus Crystal</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>So, each Job can request you collect multiple <em>loots</em> as well as more than one type of <em>loot</em>. Here is a good example of what I mean by this:</p>
<div id="cell-13" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tasksSubset.loc[<span class="dv">28</span>].Tasks </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<pre><code>'Collect: 5 Zero Systems CPU 16 Hardened Metals'</code></pre>
</div>
</div>
<p>As you can see, this task requires you to collect both <strong>Zero System CPUs</strong> as well as <strong>Hardened Metals</strong> - and a good number of them. What we want is to not only extract each type of loot independently of each other but <em>also</em> to keep the count paired with the loot type.</p>
<p>I would like to take this moment to thank the developers of Pandas. I spent a bit of time thinking about how I would solve this and they had already included a solution to this problem: <code>extractall()</code>. What this does is allows you to pass <strong>Regular Expressions</strong> and it will then pull out anything in the string which matches. It even puts them into their own separate rows! Again, thank you!</p>
<p>For Regular Expressions, this is something you will have to learn on your own. I used a <a href="https://regexr.com">website</a> to test and build mine from an example row; there is plenty of documentaiton about how to use these.</p>
<div id="cell-17" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>regex <span class="op">=</span> <span class="vs">r"(\d+\s[\w]+\s[\w]+)"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tasksSubset.Tasks.<span class="bu">str</span>.extractall(regex)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tmp.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Hydraulic Piston</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10 Hardened Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Derelict Explosives</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">8</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Zero Systems</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Ball Bearings</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Toxic Glands</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1 Master Unit</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">20</td>
<td data-quarto-table-cell-role="th">0</td>
<td>3 Ball Bearings</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Hydraulic Piston</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">24</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Hardened Bone</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>12 Compound Sheets</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">28</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5 Zero Systems</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>16 Hardened Metals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Miniature Reactor</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td data-quarto-table-cell-role="th">0</td>
<td>10 Derelict Explosives</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Perfect! Now we have all the different loot and we got to keep the row’s index for later when we’ll attach the job name and description. Before that though, we’ll need to do some work to separate the count and the loot type into their own columns. While I’m sure there is a better way to do this, I could not think of one so we’re going to write a function to break the loot and count apart and then return them.</p>
<p>There is a solid function for this already called <code>.split()</code> and we’re going to use it to split on spaces but we since some of the loot is multiple words we need to force it to only split once.</p>
<div id="cell-20" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>example <span class="op">=</span> tmp.reset_index()[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>parts <span class="op">=</span> example.split(<span class="st">' '</span>, maxsplit<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>number, loot <span class="op">=</span> <span class="bu">int</span>(parts[<span class="dv">0</span>]), parts[<span class="dv">1</span>]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>number, loot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>(10, 'Hardened Metals')</code></pre>
</div>
</div>
<p>Now we’ll create the function. What we can do here though is return either the <code>count</code> value or the <code>loot</code> value depending on an index passed: 0 for <code>count</code> and 1 for <code>loot</code>.</p>
<div id="cell-22" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakLoot(taskString, index<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    parts <span class="op">=</span> taskString.split(<span class="st">' '</span>, maxsplit<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(parts[index])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> index <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> parts[index]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This shouldn't be called.</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we just run two <code>.apply()</code> calls to get the values out:</p>
<div id="cell-24" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> tmp.reset_index()[<span class="dv">0</span>].<span class="bu">apply</span>(breakLoot).values</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>aLoot <span class="op">=</span> tmp.reset_index()[<span class="dv">0</span>].<span class="bu">apply</span>(breakLoot, index<span class="op">=</span><span class="dv">1</span>).values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And, then assign them to our brand new columns for them.</p>
<div id="cell-26" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.assign(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> count,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    loot <span class="op">=</span> aLoot</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>tmp.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">loot</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Hydraulic Piston</td>
<td>2</td>
<td>Hydraulic Piston</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10 Hardened Metals</td>
<td>10</td>
<td>Hardened Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Derelict Explosives</td>
<td>4</td>
<td>Derelict Explosives</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">8</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Zero Systems</td>
<td>2</td>
<td>Zero Systems</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Toxic Glands</td>
<td>2</td>
<td>Toxic Glands</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1 Master Unit</td>
<td>1</td>
<td>Master Unit</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">20</td>
<td data-quarto-table-cell-role="th">0</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Hydraulic Piston</td>
<td>3</td>
<td>Hydraulic Piston</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">24</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Hardened Bone</td>
<td>4</td>
<td>Hardened Bone</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>12 Compound Sheets</td>
<td>12</td>
<td>Compound Sheets</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">28</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5 Zero Systems</td>
<td>5</td>
<td>Zero Systems</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>16 Hardened Metals</td>
<td>16</td>
<td>Hardened Metals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Miniature Reactor</td>
<td>4</td>
<td>Miniature Reactor</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td data-quarto-table-cell-role="th">0</td>
<td>10 Derelict Explosives</td>
<td>10</td>
<td>Derelict Explosives</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>And, there we go! We have our columns how we want them. Now we just need to work on getting the <code>Name</code> and <code>Description</code> values attached to our new data frame. One way to do this would be to do some sort of merge or join based on the index we’ve saved. Or, we can do something even easier!</p>
<p>If we look at the rows when we do an index reset:</p>
<div id="cell-29" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tmp.reset_index().head(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level_0</th>
<th data-quarto-table-cell-role="th">match</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">loot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>2 Hydraulic Piston</td>
<td>2</td>
<td>Hydraulic Piston</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
<td>10 Hardened Metals</td>
<td>10</td>
<td>Hardened Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>0</td>
<td>4 Derelict Explosives</td>
<td>4</td>
<td>Derelict Explosives</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8</td>
<td>0</td>
<td>2 Zero Systems</td>
<td>2</td>
<td>Zero Systems</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8</td>
<td>1</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>12</td>
<td>0</td>
<td>2 Toxic Glands</td>
<td>2</td>
<td>Toxic Glands</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>16</td>
<td>0</td>
<td>1 Master Unit</td>
<td>1</td>
<td>Master Unit</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>20</td>
<td>0</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>… we can see that the column <code>level_0</code> actaully contains duplicate indexes from our matches. So, the values <code>Hydraulic Piston</code> and <code>Hardened Metals</code> both are associated with <em>Task with index 0</em>. As long as we can use that index to get duplicate values then we can just pull all the <code>Name</code> and <code>Descriptions</code> in their matching order.</p>
<div id="cell-31" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tasksSubset.loc[tmp.reset_index().loc[:<span class="dv">5</span>, <span class="st">"level_0"</span>], [<span class="st">'Name'</span>, <span class="st">'Description'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>None of your Business</td>
<td>Prospector. We need Toxic Glands. Don't ask qu...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>… which is exactly what we get! Duplicates! Time to slice it out and then assign the values.</p>
<div id="cell-33" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>nameDescriptSlice <span class="op">=</span> tasksSubset.loc[tmp.reset_index()[<span class="st">"level_0"</span>], [<span class="st">'Name'</span>, <span class="st">'Description'</span>]]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>tmp <span class="op">=</span> tmp.assign(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> nameDescriptSlice.Name.values,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    description <span class="op">=</span> nameDescriptSlice.Description.values</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>tmp.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">loot</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">description</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Hydraulic Piston</td>
<td>2</td>
<td>Hydraulic Piston</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10 Hardened Metals</td>
<td>10</td>
<td>Hardened Metals</td>
<td>New Mining Tools</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Derelict Explosives</td>
<td>4</td>
<td>Derelict Explosives</td>
<td>Explosive Excavation</td>
<td>One of our mines collapsed with valuable equip...</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">8</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Zero Systems</td>
<td>2</td>
<td>Zero Systems</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
<td>Mining Bot</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2 Toxic Glands</td>
<td>2</td>
<td>Toxic Glands</td>
<td>None of your Business</td>
<td>Prospector. We need Toxic Glands. Don't ask qu...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1 Master Unit</td>
<td>1</td>
<td>Master Unit</td>
<td>Insufficient Processing Power</td>
<td>Prospector! The Zero Systems CPU you brought u...</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">20</td>
<td data-quarto-table-cell-role="th">0</td>
<td>3 Ball Bearings</td>
<td>3</td>
<td>Ball Bearings</td>
<td>Excavator Improvements</td>
<td>The suspension on our mining excavators need i...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3 Hydraulic Piston</td>
<td>3</td>
<td>Hydraulic Piston</td>
<td>Excavator Improvements</td>
<td>The suspension on our mining excavators need i...</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">24</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Hardened Bone</td>
<td>4</td>
<td>Hardened Bone</td>
<td>A new type of Alloy</td>
<td>Our scientists are confident they can create a...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>12 Compound Sheets</td>
<td>12</td>
<td>Compound Sheets</td>
<td>A new type of Alloy</td>
<td>Our scientists are confident they can create a...</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">28</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5 Zero Systems</td>
<td>5</td>
<td>Zero Systems</td>
<td>Automated Security</td>
<td>We will have to build new turrets to help prot...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>16 Hardened Metals</td>
<td>16</td>
<td>Hardened Metals</td>
<td>Automated Security</td>
<td>We will have to build new turrets to help prot...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td data-quarto-table-cell-role="th">0</td>
<td>4 Miniature Reactor</td>
<td>4</td>
<td>Miniature Reactor</td>
<td>Energy Crisis</td>
<td>Veltecite supplies are low, but we need energy...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td data-quarto-table-cell-role="th">0</td>
<td>10 Derelict Explosives</td>
<td>10</td>
<td>Derelict Explosives</td>
<td>Classified I</td>
<td>Prospector! We need Derelict Explosives, Maste...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Finally, we’ll drop all those extra columns we don’t need.</p>
<div id="cell-35" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tmp.reset_index().drop([</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'level_0'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'match'</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>], axis <span class="op">=</span><span class="dv">1</span> )</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>tasks <span class="op">=</span> tasks[[<span class="st">'name'</span>, <span class="st">'count'</span>, <span class="st">'loot'</span>, <span class="st">'description'</span>]]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>tasks.head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">loot</th>
<th data-quarto-table-cell-role="th">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>New Mining Tools</td>
<td>2</td>
<td>Hydraulic Piston</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>New Mining Tools</td>
<td>10</td>
<td>Hardened Metals</td>
<td>We are producing new Mining Tools for new Pros...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Explosive Excavation</td>
<td>4</td>
<td>Derelict Explosives</td>
<td>One of our mines collapsed with valuable equip...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Mining Bot</td>
<td>2</td>
<td>Zero Systems</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Mining Bot</td>
<td>3</td>
<td>Ball Bearings</td>
<td>Our engineers have designed an autonomous mini...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>None of your Business</td>
<td>2</td>
<td>Toxic Glands</td>
<td>Prospector. We need Toxic Glands. Don't ask qu...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Insufficient Processing Power</td>
<td>1</td>
<td>Master Unit</td>
<td>Prospector! The Zero Systems CPU you brought u...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Excavator Improvements</td>
<td>3</td>
<td>Ball Bearings</td>
<td>The suspension on our mining excavators need i...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Excavator Improvements</td>
<td>3</td>
<td>Hydraulic Piston</td>
<td>The suspension on our mining excavators need i...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>A new type of Alloy</td>
<td>4</td>
<td>Hardened Bone</td>
<td>Our scientists are confident they can create a...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>A new type of Alloy</td>
<td>12</td>
<td>Compound Sheets</td>
<td>Our scientists are confident they can create a...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Automated Security</td>
<td>5</td>
<td>Zero Systems</td>
<td>We will have to build new turrets to help prot...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Automated Security</td>
<td>16</td>
<td>Hardened Metals</td>
<td>We will have to build new turrets to help prot...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Energy Crisis</td>
<td>4</td>
<td>Miniature Reactor</td>
<td>Veltecite supplies are low, but we need energy...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Classified I</td>
<td>10</td>
<td>Derelict Explosives</td>
<td>Prospector! We need Derelict Explosives, Maste...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>And, there we have it! Another piece to the puzzle solved. Next we’re going to work to combine all the faction rewards, the job requirements and the loot tables together to finally calculate which jobs you should definitly avoid doing.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>